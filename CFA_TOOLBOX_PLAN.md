# CFA金融工具箱 - 完整规划文档

## 📚 项目愿景

打造一个全面的CFA考试辅助工具箱，涵盖CFA一级、二级、三级的所有核心考点和公式，帮助考生理解、记忆和应用金融公式，提升备考效率。

## 🎯 核心特性

### 1. 全面覆盖
- 涵盖CFA一二三级所有核心考点
- 包含200+个常用金融公式
- 支持50+种计算工具

### 2. 公式说明
- 每个公式都有详细的数学表达式
- 清晰的参数定义和单位说明
- 公式推导过程和理论基础
- 应用场景和注意事项

### 3. 交互计算
- 实时参数输入和结果计算
- 参数范围验证和错误提示
- 计算步骤详细展示
- 结果可视化图表

### 4. 学习辅助
- 公式收藏和笔记功能
- 学习进度跟踪
- 相关公式推荐
- 典型例题和解析

## 📖 CFA知识体系分类

### Level I - 基础知识（10个科目）

#### 1. 定量方法（Quantitative Methods）
**工具列表：**
- ✅ 货币时间价值计算器
  - 现值/终值计算
  - 年金现值/终值
  - 永续年金
  - 不规则现金流NPV/IRR
- ✅ 统计分析工具
  - 描述性统计（均值、方差、标准差）
  - 概率分布（正态分布、二项分布）
  - 置信区间计算
  - 假设检验
- ✅ 回归分析工具
  - 简单线性回归
  - 多元回归
  - R²和调整R²
  - 残差分析

#### 2. 经济学（Economics）
**工具列表：**
- ✅ 供需分析工具
  - 均衡价格计算
  - 弹性计算（价格弹性、收入弹性）
  - 消费者剩余/生产者剩余
- ✅ GDP计算器
  - 支出法GDP
  - 收入法GDP
  - 实际GDP vs 名义GDP
- ✅ 汇率计算器
  - 直接标价法/间接标价法
  - 交叉汇率
  - 远期汇率
  - 利率平价

#### 3. 财务报表分析（Financial Statement Analysis）
**工具列表：**
- ✅ 财务比率计算器
  - 流动性比率（流动比率、速动比率）
  - 偿债能力比率（资产负债率、利息保障倍数）
  - 营运效率比率（存货周转率、应收账款周转率）
  - 盈利能力比率（ROE、ROA、利润率）
- ✅ 杜邦分析工具
  - 三因素杜邦分析
  - 五因素杜邦分析
- ✅ 现金流分析工具
  - 经营现金流计算
  - 自由现金流计算
  - 现金流量表分析

#### 4. 公司金融（Corporate Finance）
**工具列表：**
- ✅ 资本预算工具
  - NPV计算器
  - IRR计算器
  - 回收期计算
  - 盈利指数
- ✅ 资本成本计算器
  - 股权成本（CAPM、DDM）
  - 债务成本
  - WACC计算
- ✅ 杠杆分析工具
  - 经营杠杆（DOL）
  - 财务杠杆（DFL）
  - 综合杠杆（DTL）
- ✅ 营运资本管理
  - 现金周期计算
  - 最优现金余额

#### 5. 权益投资（Equity Investments）
**工具列表：**
- ✅ 股票估值工具
  - DDM模型（零增长、固定增长、多阶段增长）
  - ✅ DCF估值（已实现）
  - ✅ 相对估值（P/E、P/B、P/S、EV/EBITDA）（已实现）
- ✅ 股票分析工具
  - 持有期收益率
  - 股息收益率
  - 资本利得收益率
- ✅ 市场指数工具
  - 价格加权指数
  - 市值加权指数
  - 等权重指数

#### 6. 固定收益（Fixed Income）
**工具列表：**
- ✅ 债券定价工具（已实现）
  - 债券价格计算
  - 到期收益率（YTM）
  - 即期利率和远期利率
- ✅ 债券风险指标（已实现）
  - 久期（Macaulay Duration）
  - 修正久期（Modified Duration）
  - 凸性（Convexity）
  - 有效久期
- ✅ 债券组合管理
  - 免疫策略
  - 子弹型/杠铃型策略

#### 7. 衍生品（Derivatives）
**工具列表：**
- ✅ 期权定价工具（已实现）
  - Black-Scholes模型
  - 二叉树模型
  - Greeks指标
- ✅ 期货定价工具
  - 期货理论价格
  - 基差分析
  - 套期保值比率
- ✅ 远期合约工具
  - 远期价格计算
  - 远期利率协议（FRA）
- ✅ 互换工具
  - 利率互换定价
  - 货币互换定价

#### 8. 另类投资（Alternative Investments）
**工具列表：**
- ✅ 房地产投资分析
  - NOI计算
  - Cap Rate
  - 现金流折现
- ✅ 私募股权分析
  - IRR计算
  - 倍数分析（MOIC、DPI）
- ✅ 对冲基金指标
  - 夏普比率
  - Sortino比率
  - 最大回撤

#### 9. 投资组合管理（Portfolio Management）
**工具列表：**
- ✅ 投资组合优化（已实现）
  - 马科维茨模型
  - 有效前沿
  - 资本市场线（CML）
  - 证券市场线（SML）
- ✅ 资产配置工具
  - 战略资产配置
  - 战术资产配置
- ✅ 业绩评估工具
  - 夏普比率
  - 特雷诺比率
  - 詹森Alpha
  - 信息比率

#### 10. 风险管理
**工具列表：**
- ✅ 风险价值（VaR）（已实现）
  - 历史模拟法
  - 方差-协方差法
  - 蒙特卡洛模拟
- ✅ 风险指标计算
  - Beta系数
  - 标准差
  - 下行风险
  - CVaR

### Level II - 进阶应用（重点科目）

#### 财务报表分析进阶
- 跨国公司财务分析
- 养老金会计
- 并购分析

#### 权益投资进阶
- 剩余收益模型（RI）
- 自由现金流模型（FCFF/FCFE）
- 价格倍数分析

#### 固定收益进阶
- 信用分析
- 资产支持证券（ABS）
- 利率期限结构

#### 衍生品进阶
- 奇异期权
- 信用衍生品
- 利率衍生品

### Level III - 投资组合管理（重点科目）

#### 投资组合构建
- IPS制定
- 资产配置策略
- 再平衡策略

#### 业绩评估
- 归因分析
- 风险调整收益
- 基准选择

## 🏗️ 技术架构设计

### 1. 数据库设计

```sql
-- 工具分类表
CREATE TABLE tool_categories (
  id UUID PRIMARY KEY,
  name TEXT NOT NULL,
  name_en TEXT NOT NULL,
  level TEXT NOT NULL, -- 'L1', 'L2', 'L3', 'ALL'
  subject TEXT NOT NULL, -- 科目名称
  icon TEXT,
  sort_order INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 工具表
CREATE TABLE tools (
  id UUID PRIMARY KEY,
  category_id UUID REFERENCES tool_categories(id),
  name TEXT NOT NULL,
  name_en TEXT NOT NULL,
  description TEXT,
  level TEXT NOT NULL,
  route_path TEXT NOT NULL,
  icon TEXT,
  sort_order INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 公式库表
CREATE TABLE formulas (
  id UUID PRIMARY KEY,
  tool_id UUID REFERENCES tools(id),
  name TEXT NOT NULL,
  name_en TEXT NOT NULL,
  latex_formula TEXT NOT NULL, -- LaTeX格式公式
  description TEXT,
  derivation TEXT, -- 公式推导
  application TEXT, -- 应用场景
  notes TEXT, -- 注意事项
  level TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 公式参数表
CREATE TABLE formula_parameters (
  id UUID PRIMARY KEY,
  formula_id UUID REFERENCES formulas(id),
  symbol TEXT NOT NULL, -- 参数符号
  name TEXT NOT NULL, -- 参数名称
  name_en TEXT NOT NULL,
  description TEXT, -- 参数说明
  unit TEXT, -- 单位
  default_value NUMERIC,
  min_value NUMERIC,
  max_value NUMERIC,
  sort_order INTEGER,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- 用户收藏表
CREATE TABLE user_favorites (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES profiles(id),
  tool_id UUID REFERENCES tools(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(user_id, tool_id)
);

-- 用户笔记表
CREATE TABLE user_notes (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES profiles(id),
  tool_id UUID REFERENCES tools(id),
  formula_id UUID REFERENCES formulas(id),
  content TEXT NOT NULL,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- 学习进度表
CREATE TABLE learning_progress (
  id UUID PRIMARY KEY,
  user_id UUID REFERENCES profiles(id),
  tool_id UUID REFERENCES tools(id),
  status TEXT NOT NULL, -- 'not_started', 'in_progress', 'completed'
  practice_count INTEGER DEFAULT 0,
  last_practiced_at TIMESTAMPTZ,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

### 2. 组件设计

#### FormulaDisplay 组件
显示公式的LaTeX渲染、参数说明、推导过程

#### ParameterInput 组件
智能参数输入，带验证、单位转换、范围提示

#### CalculationSteps 组件
展示计算步骤，帮助理解计算过程

#### FormulaLibrary 组件
公式库浏览、搜索、收藏功能

#### LearningPath 组件
学习路径规划、进度跟踪

### 3. 页面结构

```
/tools
  /quantitative
    /time-value-money
    /statistics
    /regression
  /economics
    /supply-demand
    /gdp
    /exchange-rate
  /fsa
    /financial-ratios
    /dupont-analysis
    /cash-flow
  /corporate-finance
    /capital-budgeting
    /cost-of-capital
    /leverage
  /equity
    /stock-valuation
    /ddm
    /dcf (已实现)
    /relative-valuation (已实现)
  /fixed-income
    /bond-pricing (已实现)
    /duration-convexity (已实现)
    /yield-curve
  /derivatives
    /option-pricing (已实现)
    /futures
    /forwards
    /swaps
  /alternatives
    /real-estate
    /private-equity
    /hedge-funds
  /portfolio
    /optimization (已实现)
    /asset-allocation
    /performance
  /risk
    /var (已实现)
    /risk-metrics
```

## 📱 用户界面设计

### 1. 首页
- CFA级别选择（L1/L2/L3）
- 科目分类导航
- 最近使用的工具
- 学习进度仪表板

### 2. 工具页面
- 左侧：参数输入面板
- 中间：计算结果展示
- 右侧：公式说明面板
  - 公式LaTeX渲染
  - 参数定义表格
  - 公式推导（可折叠）
  - 应用场景说明
  - 注意事项
  - 相关公式链接

### 3. 公式库页面
- 公式搜索和筛选
- 按科目/级别分类
- 收藏的公式
- 我的笔记

### 4. 学习中心
- 学习路径
- 进度统计
- 练习记录
- 薄弱环节分析

## 🚀 实施计划

### Phase 1: 基础架构（当前阶段）
- [x] 创建数据库表结构
- [x] 实现公式显示组件
- [x] 创建工具分类系统
- [x] 实现基础导航

### Phase 2: 核心工具（优先级高）
- [ ] 货币时间价值计算器
- [ ] 财务比率计算器
- [ ] 统计分析工具
- [ ] 资本预算工具
- [ ] 股票估值工具（DDM）

### Phase 3: 进阶工具
- [ ] 回归分析工具
- [ ] 杜邦分析工具
- [ ] 杠杆分析工具
- [ ] 期货定价工具
- [ ] 互换定价工具

### Phase 4: 学习功能
- [ ] 公式收藏功能
- [ ] 笔记功能
- [ ] 学习进度跟踪
- [ ] 练习模式

### Phase 5: 高级功能
- [ ] 公式搜索引擎
- [ ] 相关公式推荐
- [ ] 学习路径规划
- [ ] 数据可视化增强

## 📊 成功指标

1. **覆盖率**: 涵盖CFA考试80%以上的核心公式
2. **准确性**: 所有计算结果经过验证，准确率100%
3. **易用性**: 用户能在30秒内找到并使用任何工具
4. **学习效果**: 用户使用后对公式理解度提升50%以上

## 🎓 教育价值

1. **理解公式**: 不仅提供计算，更帮助理解公式背后的原理
2. **记忆辅助**: 通过实际应用加深对公式的记忆
3. **考试准备**: 模拟考试场景，提升应试能力
4. **实践应用**: 连接理论与实践，培养实际分析能力
